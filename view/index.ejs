
<%- include("partials/header", {title: title}) %>
<main>
    <h1>Index message board</h1>
    <% if(locals.currentUser) { %>
        <h2>Welcome <%= currentUser.forename %> you are logged in as <%= currentUser.role%></h2>

    <% allMessages.forEach( message => { %>

        <section>
            <div class="title-date-container">
                <h3 class="message-title"><%= message.title %></h3>
                <% if(locals.currentUser.role !== "user") { %>
                <p class="message-date">created at <%= message.date %></p>
                <% } %>
            </div>
            <p class="message-text"><%= message.message %></p>
            <% if(locals.currentUser.role !== "user") { %>
            <div class="author-delete-container">
                <p class="message-author">Created by <%= message.forename %> <%= message.surname %> </p>
                <% if(locals.currentUser.role === "admin") { %>
                    <div id="delete-btn" data-id="<%= message.id %>"><i class="fa-solid fa-trash-can"></i></div>
                <% } %>
            </div>
            <% } %>
        </section>
    <% }) %>
    <% } %>
</main>

<div id="delete-overlay">
    <div id="delete-container">
        <p>Do you want to delete this message?</p>
        <div class="delete-buttons">
            <button id="delete-confirm">Delete</button>
            <button id="delete-cancel">Cancel</button>
        </div>
    </div>
</div>

<%- include("partials/footer") %>

